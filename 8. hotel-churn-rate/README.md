**Прогнозирование оттока клиентов в сети отелей «Как в гостях»¶**

Описание проекта

Заказчик этого исследования — сеть отелей «Как в гостях».

Чтобы привлечь клиентов, эта сеть отелей добавила на свой сайт возможность забронировать номер без предоплаты. Однако если клиент отменял бронирование, то компания терпела убытки. Сотрудники отеля могли, например, закупить продукты к приезду гостя или просто не успеть найти другого клиента.

**Цель:**

- Разработать систему, которая предсказывает отказ от брони. 
- Если модель покажет, что бронь будет отменена, то клиенту предлагается внести депозит. 
- Размер депозита — 80% от стоимости номера. 
- Деньги будут списаны со счёта клиента, если он всё же отменит бронь.

**Выводы проекта:**

 **Исследовательский анализ целевого признака**:
- Примерно 40% бронированний было отменено
- Время выполнения заказа (lead time) наиболее тесно связано с тем, отменено бронирование или нет. Имеет смысл, что по мере увеличения количества дней между моментом оформления бронирования и предполагаемой датой прибытия у клиентов появляется больше времени для отмены бронирования и больше времени для возникновения непредвиденных обстоятельств, срывающих планы поездок.
- Интересно, что общее количество специальных запросов (total_of_special_requests) является второй функцией, которая наиболее сильно коррелирует с нашей целью отмены. По мере увеличения количества особых запросов вероятность отмены бронирования уменьшается. Это говорит о том, что взаимодействие с отелем до прибытия и ощущение, что их потребности услышаны, может снизить вероятность отмены бронирования клиентом.
- Что касается особых запросов, количество необходимых парковочных мест (requires_car_parking_spaces) является третьей функцией, которая наиболее сильно коррелирует с нашей целью отмены. По мере увеличения количества запросов на парковочные места вероятность отмены бронирования уменьшается. Потенциальные причины этой взаимосвязи будут рассмотрены ниже.
- Интересно, что предыдущая история клиента с отелем (измеряемая количеством предыдущих бронирований, которые не были отменены (previous_bookings_not_canceled), или независимо от того, является ли клиент постоянным гостем(is_repeated_guest), по-видимому, не сильно коррелирует с тем, будет ли отменено текущее бронирование. С другой стороны, предыдущая история отмены бронирования клиента (измеряемая количеством предыдущих отмен(previous_cancellations)) в большей степени коррелирует с тем, будет ли отменено текущее бронирование
- Отмененные заказы в среднем имеют более длительное время выполнения
- Клиенты, которые отменяют свои бронирования, в среднем делают меньше особых запросов
- Меньше бронирований отменяется (или сохраняется) примерно в январе. Больше бронирований отменяется (и сохраняется) в теплые месяцы с апреля по июль
- Клиенты, забронировавшие типы номеров G и H, имеют самый высокий процент отмены бронирования. Клиенты номеров типа B вообще не отменяют бронирования. Поскольку в наборе данных не были указаны фактические обозначения номеров в целях анонимности, трудно понять, почему эти бронирования номеров типа чаще отменяются или не отменяются совсем.

**Разработка модели ML**:
- Были обучены модели методами: 
  - Случайный Лес(roc_auc=0.81146)
  - Логистическая Регрессия(roc_auc=0.79138)
  - Дерево Решений (roc_auc=0.72976)
- Были построены матрицы ошибок для всех методов и получены следующие результаты:
  - Случайный лес:
    - Правильно классифицированные: 67.0%
    - Правильно классифицированные отмененные бронирования: 89.0%
    - Правильно классифицированые не отмененные бронирования: 56.0%
    - Прогнозируемые отмененные бронирования, которые на самом деле отменены: 50.0%
    - Прогнозируемые не отмененные бронирования, которые на самом деле не отменены: 91.0%
  - Логистическая регрессия:
    - Правильно классифицированные: 72.0%
    - Правильно классифицированые отмененные бронирования: 68.0%
    - Правильно классифицированые не отмененные бронирования: 90.0%
    - Прогнозируемые отмененные бронирования, которые на самом деле отменены: 97.0%
    - Прогнозируемые не отмененные бронирования, которые на самом деле не отменены: 35.0%
  - Дерево решений:
    - Правильно классифицированные: 74.0%
    - Правильно классифицированые отмененные бронирования: 73.0%
    - Правильно классифицированые не отмененные бронирования: 76.0%
    - Прогнозируемые отмененные бронирования, которые на самом деле отменены: 88.0%
    - Прогнозируемые не отмененные бронирования, которые на самом деле не отменены: 55.0%
- Была получена прибыль после предсказаний моделей:
  - Выручка после обучения модели Random Forest: 124 515 160
  - Выручка после обучения модели Logistic Regression: 112 615 880
  - Выручка после обучения модели Decision Forest: 117 057 160
- Модели принесут компании выручку:
  - Random Forest принесёт компании выручку: 20 347 480
  - Модель Logistic Regression принесёт компании выручку: 8 448 200
  - Модель Decision Forest принесёт компании выручку: 12 889 480

**Исследовательский анализ ненадежного клиента**
- Наличие дней ожидания между датой заезда и датой прибытия, люди из Португалии и Великобритании, наличие парковочных мест для автомобилей и отмена предыдущего бронирования - это 5 фичей, которые имеют наибольшее значение для прогнозирования того, что бронирование будет отменено по мнению модели "Случайный лес". Наиболее склонными к отказу от брони по мнению модели так же являются люди, у которых имеется время ожидания между датой бронирования и датой прибытия
- По мнению модели примерно 70% бронирований будет отменено, когда самом деле было отменено до 30% бронирований!
- Похожая картина наблюдается как в отмененных, так и в не отмененных бронированиях. Меньше бронирований отменяется (или сохраняется) примерно в январе. Больше бронирований отменяется (и сохраняется) в теплые месяцы с апреля по июль. тем не менее графики до и после кардинально отличаются по количеству отмененных и не отмененных бронирований. До обучения количество отмненных бронирований существенно превышало не отменененные, после обучения всё стало наоборот. 
- После обучения модели у большинства типов номеров % отмены бронирования достаточно высок 60+ % когда до обучения максимальный процент отмены бронирования был равен 35%

**Из полученных данных можно сделать вывод, что наивысшее значение roc_auc и наиболее оптимальные параметры у модели Случайный Лес и лучше выбрать именно её. Модель Random Forest предсказывает прибыль 124 515 160 и принесёт компании выручку: 20 347 480 (что точно позволят окупить затраты на разработку системы прогнозирования равную 400 000)**

**Стек:**

pandas, numpy, math, matplotlib, pyplot, scipy, seaborn, sklearn, time, sklearn

**Статус проекта:**

Завершен.
