**Промышленность**

Чтобы оптимизировать производственные расходы, металлургический комбинат ООО «Стальная птица» решил уменьшить потребление электроэнергии на этапе обработки стали.

**Цель:**

- Построить модель, которая будет предсказывать температуру стали

**Выводы проекта:**

В качестве итоговой модели выбран Градиентный Бустинг (реализация LightGBM), качество модели по метрике MAE на тестовой выборке составила 5,57.

**Этап предобработки**:

Приведение к типу datetime данных, содержащих дату и время технологического процесса во всех таблицах.
Агрегация данных по ключу партии в таблицах, записи в которых не уникальны по ключам (электроды, замеры температуры).
Добавление новых признаков: количество циклов нагрева, общая мощность и энергия на нагрев стали, суммарный объем сыпучих материалов, суммарный объем проволочных материалов, длительность процессов нагрева, обработки сыпучими материалами и обработки проволочными материалами.
Удаление некорректных данных (реактивная мощность меньше нуля; начальная температура меньше 1300 град; материалы, использованные в единичных случаях; отсутствие замера конечной температуры; наличие операций после замера конечной температуры )
Соединение данных по ключу партии, тип связи - внутреннее соединение.
Этап обучения:

Разделение данных на обучающую и тестовую выборки в соотношении 3:1

*Линейные модели*:

- Масштабирование признаков
- Оценка модели на кросс-валидации для линейной регрессии без регуляризации, LASSO и RIDGE. Для моделей LASSO и RIDGE случайный перебор гиперпараметра alpha, харакетризующего степень регуляризации. Лучшее качество на кросс-валидации MAE=6.11. достигнуто при использовании модели LASSO c гиперпараметром 'alpha' = 0.14

*Случайный лес*:

- Оценка модели на кросс-валидации cо случайным перебором гиперпараметров 'max_features' и 'bootstrap'. Оптимальные значения гиперпараметров: 'max_features'=0.65, 'bootstrap'= True
- Определение оптимального количества деревьев для фиксированных значений 'max_features'и 'bootstrap' из предыдущего пункта: n_estimators=200. MAE лучшей модели на кросс-валидации: 6.46.

*Градиентный Бустинг*:

- Оценка модели на кросс-валидации cо случайным перебором гиперпараметров {'max_depth', 'subsample' 'feature_fraction', 'reg_alpha', 'reg_lambda'} на 100 итерациях бустинга. 
- Лучшие гиперпараметры модели: {'subsample': 0.6, 'reg_lambda': 5, 'reg_alpha': 0.35000000000000003, 'max_depth': 9, 'feature_fraction': 0.8999999999999999}. MAE на кросс-валидации 6.15 град. early_stopping_rounds=25, feature_fraction=0.8999999999999999,
- Запуск обучения на выбранном наборе гиперпараметров с количеством итерации, равным 2000 и темпом обучения 0.005. Включение ранней остановки по метрике MAE для валидационной выборки при отсутствии улучшении качества на 25 циклах. MAE для валидационной выборки 5,96.

*Нейронная сеть*:

- MAE для тестовой выборки 8.29

***Модель Градиентного Бустинга выбрана в качестве лучшей модели***

**Этап тестирования**:

- Оценка качества модели Градиентного бустинга на отложенной выборке. MAE=5.57.
- Обученная модель Градиентного Бустинга с подобранными гиперпараметрами рекомендована к использованию для прогнозирования температуры стали
